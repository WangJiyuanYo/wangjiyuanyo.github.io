<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java 基础 | WANGJIYAUN</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/x-icon" href="/img/logo.ico">
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
    <meta name="description" content="懒得翻身的咸鱼">
    
    <link rel="preload" href="/assets/css/0.styles.f931473a.css" as="style"><link rel="preload" href="/assets/js/app.45c0c6a5.js" as="script"><link rel="preload" href="/assets/js/2.b44b4809.js" as="script"><link rel="preload" href="/assets/js/11.05b00173.js" as="script"><link rel="prefetch" href="/assets/js/10.21bb6e9c.js"><link rel="prefetch" href="/assets/js/12.d27a311a.js"><link rel="prefetch" href="/assets/js/13.6819fc77.js"><link rel="prefetch" href="/assets/js/14.7ded249e.js"><link rel="prefetch" href="/assets/js/15.fffac48a.js"><link rel="prefetch" href="/assets/js/16.6919d9b5.js"><link rel="prefetch" href="/assets/js/17.c6a571f1.js"><link rel="prefetch" href="/assets/js/18.7579ee3c.js"><link rel="prefetch" href="/assets/js/19.9d3c72cc.js"><link rel="prefetch" href="/assets/js/20.c05479c1.js"><link rel="prefetch" href="/assets/js/21.7b69d5ed.js"><link rel="prefetch" href="/assets/js/22.cd39376a.js"><link rel="prefetch" href="/assets/js/23.6dd9e50f.js"><link rel="prefetch" href="/assets/js/24.207afb51.js"><link rel="prefetch" href="/assets/js/25.f61ff141.js"><link rel="prefetch" href="/assets/js/26.14c69bf4.js"><link rel="prefetch" href="/assets/js/27.21455f21.js"><link rel="prefetch" href="/assets/js/28.2fb41b15.js"><link rel="prefetch" href="/assets/js/3.5aefe87b.js"><link rel="prefetch" href="/assets/js/4.2e219475.js"><link rel="prefetch" href="/assets/js/5.934eb362.js"><link rel="prefetch" href="/assets/js/6.1ccf8798.js"><link rel="prefetch" href="/assets/js/7.95649921.js"><link rel="prefetch" href="/assets/js/8.185adbc5.js"><link rel="prefetch" href="/assets/js/9.abe914e8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f931473a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="global-layout"><div class="loading"><div><div class="loader"></div> <div class="text">正在加载中~</div></div></div> <div id="landlord" data-v-1c077c9b><div class="chat-box" data-v-1c077c9b></div> <audio id="mp3" controls="controls" controlsList="nodownload" hidden="hidden" data-v-1c077c9b><source type="audio/mp3" data-v-1c077c9b></audio> <div class="robot-box robot" data-v-f412ca4a data-v-1c077c9b><input type="text" placeholder="回车或点击发送和我聊天吧~" value="" data-v-f412ca4a> <div class="btn" data-v-f412ca4a>发送</div></div> <canvas id="live2d" width="280" height="250" class="live2d" data-v-1c077c9b></canvas></div> <div class="bg"></div> <div class="index-box" data-v-82e3e2fc><div class="nav-box" data-v-0bc0d532 data-v-82e3e2fc><div class="search-nav"><div class="search-box" data-v-6597e726><input autofocus="autofocus" placeholder="搜索" value="" data-v-6597e726> <!----></div></div> <div class="nav"></div> <div class="info-box" data-v-0bc0d532><img src="https://yating.online/res/img/yating.jpg" class="my-phone" data-v-0bc0d532> <div class="info" data-v-0bc0d532><div data-v-0bc0d532><div class="my-name" data-v-0bc0d532>WANGJIYUAN</div> <div class="des" data-v-0bc0d532>懒得翻身的咸鱼</div></div></div></div></div> <div class="box" data-v-69b40e18 data-v-82e3e2fc><div class="tag-box" data-v-69b40e18><div class="tag-item" data-v-69b40e18><div class="tag-name" data-v-69b40e18>全部</div> <div class="tag-num" data-v-69b40e18>0</div></div> </div></div> <div class="content-box" data-v-82e3e2fc><div class="content"><div class="catalog-item-big"><div class="title">
                    
                </div> <div class="article-time">
                    5/16/2021, 9:43:11 PM
                </div></div> <div class="content__default"><h1 id="java基础"><a href="#java基础" class="header-anchor">#</a> Java基础</h1> <h2 id="线程相关"><a href="#线程相关" class="header-anchor">#</a> 线程相关</h2> <h3 id="threadpoolexecutor"><a href="#threadpoolexecutor" class="header-anchor">#</a> ThreadPoolExecutor</h3> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token keyword">public</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token keyword">int</span> corePoolSize<span class="token punctuation">,</span>          <span class="token comment">//线程池核心池的大小</span>
        <span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">,</span>                            <span class="token comment">//线程池最大线程数</span>
        <span class="token keyword">long</span> keepAliveTime<span class="token punctuation">,</span>                             <span class="token comment">//线程数大于核心数时，终止前多余的空闲线程等待新任务的最长时间</span>
        <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">,</span>                                  <span class="token comment">//keepAliveTime的时间单位</span>
        <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span> workQueue<span class="token punctuation">,</span>              <span class="token comment">//用来存储等待执行任务的队列</span>
        <span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">,</span>                    <span class="token comment">//线程工厂</span>
        <span class="token class-name">RejectedExecutionHandler</span> handler                <span class="token comment">//拒绝策略</span>
        <span class="token comment">// ) </span>
</code></pre></div><p>如果是JDK8的应用，可以使用<code>Instant</code>代替<code>Date</code>，<code>LocalDateTime</code>代替<code>Calendar</code>，<code>DateTimeFormatter</code>代替<code>SimpleDateFormat</code>，官方给出的解释：</p> <h3 id="datetimeformatter"><a href="#datetimeformatter" class="header-anchor">#</a> DateTimeFormatter</h3> <h2 id="java反射"><a href="#java反射" class="header-anchor">#</a> Java反射</h2> <p>注意一下<code>Class</code>实例比较和<code>instanceof</code>的差别：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Integer</span> n <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">boolean</span> b1 <span class="token operator">=</span> n <span class="token keyword">instanceof</span> <span class="token class-name">Integer</span><span class="token punctuation">;</span> <span class="token comment">// true，因为n是Integer类型</span>
<span class="token keyword">boolean</span> b2 <span class="token operator">=</span> n <span class="token keyword">instanceof</span> <span class="token class-name">Number</span><span class="token punctuation">;</span> <span class="token comment">// true，因为n是Number类型的子类</span>

<span class="token keyword">boolean</span> b3 <span class="token operator">=</span> n<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span> <span class="token comment">// true，因为n.getClass()返回Integer.class</span>
<span class="token keyword">boolean</span> b4 <span class="token operator">=</span> n<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Number</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span> <span class="token comment">// false，因为Integer.class!=Number.class</span>
</code></pre></div><h3 id="class解释"><a href="#class解释" class="header-anchor">#</a> Class解释</h3> <p><img src="https://raw.githubusercontent.com/WangJiyuanYo/typora-images/main/image-20210314220338978.png" alt="image-20210314220338978"></p> <h4 id="获取class实例demo"><a href="#获取class实例demo" class="header-anchor">#</a> 获取class实例Demo</h4> <p><img src="https://raw.githubusercontent.com/WangJiyuanYo/typora-images/main/image-20210314220134795.png" alt="image-20210314220134795"></p> <h4 id="class动态加载"><a href="#class动态加载" class="header-anchor">#</a> Class动态加载</h4> <p>JVM在执行Java程序的时候，并不是一次性把所有用到的class全部加载到内存，而是第一次需要用到class时才加载。例如：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Main.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">create</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当执行<code>Main.java</code>时，由于用到了<code>Main</code>，因此，JVM首先会把<code>Main.class</code>加载到内存。然而，并不会加载<code>Person.class</code>，除非程序执行到<code>create()</code>方法，JVM发现需要加载<code>Person</code>类时，才会首次加载<code>Person.class</code>。如果没有执行<code>create()</code>方法，那么<code>Person.class</code>根本就不会被加载。</p> <hr> <p>动态加载<code>class</code>的特性对于Java程序非常重要。利用JVM动态加载<code>class</code>的特性，我们才能在运行期根据条件加载不同的实现类。例如，Commons Logging总是优先使用Log4j，只有当Log4j不存在时，才使用JDK的logging。利用JVM动态加载特性，大致的实现代码如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Commons Logging优先使用Log4j:</span>
<span class="token class-name">LogFactory</span> factory <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isClassPresent</span><span class="token punctuation">(</span><span class="token string">&quot;org.apache.logging.log4j.Logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    factory <span class="token operator">=</span> <span class="token function">createLog4j</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    factory <span class="token operator">=</span> <span class="token function">createJdkLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">boolean</span> <span class="token function">isClassPresent</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这就是为什么我们只需要把Log4j的jar包放到classpath中，Commons Logging就会自动使用Log4j的原因。</p> <h4 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h4> <p>JVM为每个加载的<code>class</code>及<code>interface</code>创建了对应的<code>Class</code>实例来保存<code>class</code>及<code>interface</code>的所有信息；z`</p> <p>获取一个<code>class</code>对应的<code>Class</code>实例后，就可以获取该<code>class</code>的所有信息；</p> <p>通过Class实例获取<code>class</code>信息的方法称为反射（Reflection）；</p> <p>JVM总是动态加载<code>class</code>，可以在运行期根据条件来控制加载class。</p> <h4 id="class访问字段"><a href="#class访问字段" class="header-anchor">#</a> Class访问字段</h4> <p><img src="https://raw.githubusercontent.com/WangJiyuanYo/typora-images/main/image-20210314223256113.png" alt="image-20210314223256113"></p> <h3 id="反射常用api"><a href="#反射常用api" class="header-anchor">#</a> 反射常用API</h3> <p>**第一种，使用 Class.forName 静态方法。**当你知道该类的全路径名时，你可以使用该方法获取 Class 类对象。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Class</span> clz <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;java.lang.String&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>第二种，使用 .class 方法。</strong></p> <p>这种方法只适合在编译前就知道操作的 Class。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Class</span> clz <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>第三种，使用类对象的 getClass() 方法。</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Class</span> clz <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Class clz = str.getClass();</span>
<span class="token class-name">Construc</span> cst <span class="token operator">=</span> clz<span class="token punctuation">.</span><span class="token keyword">instanceof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <!----> <!----> <div class="over">
            完
            <div class="block"></div></div> <div id="gitalk-container"></div></div> <div class="catalog "><!----> <div class="level1"></div> <a href="#线程相关" nofollow class="level2">线程相关</a><a href="#threadpoolexecutor" nofollow class="level3">ThreadPoolExecutor</a><a href="#datetimeformatter" nofollow class="level3">DateTimeFormatter</a><a href="#java反射" nofollow class="level2">Java反射</a><a href="#class解释" nofollow class="level3">Class解释</a><a href="#反射常用api" nofollow class="level3">反射常用API</a> <!----></div> <!----></div></div> <div class="foot"> WANG JIYUAN BLOG</div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.45c0c6a5.js" defer></script><script src="/assets/js/2.b44b4809.js" defer></script><script src="/assets/js/11.05b00173.js" defer></script>
  </body>
</html>
