<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker | WANGJIYAUN</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/x-icon" href="/img/logo.ico">
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
    <meta name="description" content="懒得翻身的咸鱼">
    
    <link rel="preload" href="/assets/css/0.styles.f931473a.css" as="style"><link rel="preload" href="/assets/js/app.45c0c6a5.js" as="script"><link rel="preload" href="/assets/js/2.b44b4809.js" as="script"><link rel="preload" href="/assets/js/10.21bb6e9c.js" as="script"><link rel="prefetch" href="/assets/js/11.05b00173.js"><link rel="prefetch" href="/assets/js/12.d27a311a.js"><link rel="prefetch" href="/assets/js/13.6819fc77.js"><link rel="prefetch" href="/assets/js/14.7ded249e.js"><link rel="prefetch" href="/assets/js/15.fffac48a.js"><link rel="prefetch" href="/assets/js/16.6919d9b5.js"><link rel="prefetch" href="/assets/js/17.c6a571f1.js"><link rel="prefetch" href="/assets/js/18.7579ee3c.js"><link rel="prefetch" href="/assets/js/19.9d3c72cc.js"><link rel="prefetch" href="/assets/js/20.c05479c1.js"><link rel="prefetch" href="/assets/js/21.7b69d5ed.js"><link rel="prefetch" href="/assets/js/22.cd39376a.js"><link rel="prefetch" href="/assets/js/23.6dd9e50f.js"><link rel="prefetch" href="/assets/js/24.207afb51.js"><link rel="prefetch" href="/assets/js/25.f61ff141.js"><link rel="prefetch" href="/assets/js/26.14c69bf4.js"><link rel="prefetch" href="/assets/js/27.21455f21.js"><link rel="prefetch" href="/assets/js/28.2fb41b15.js"><link rel="prefetch" href="/assets/js/3.5aefe87b.js"><link rel="prefetch" href="/assets/js/4.2e219475.js"><link rel="prefetch" href="/assets/js/5.934eb362.js"><link rel="prefetch" href="/assets/js/6.1ccf8798.js"><link rel="prefetch" href="/assets/js/7.95649921.js"><link rel="prefetch" href="/assets/js/8.185adbc5.js"><link rel="prefetch" href="/assets/js/9.abe914e8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f931473a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="global-layout"><div class="loading"><div><div class="loader"></div> <div class="text">正在加载中~</div></div></div> <div id="landlord" data-v-1c077c9b><div class="chat-box" data-v-1c077c9b></div> <audio id="mp3" controls="controls" controlsList="nodownload" hidden="hidden" data-v-1c077c9b><source type="audio/mp3" data-v-1c077c9b></audio> <div class="robot-box robot" data-v-f412ca4a data-v-1c077c9b><input type="text" placeholder="回车或点击发送和我聊天吧~" value="" data-v-f412ca4a> <div class="btn" data-v-f412ca4a>发送</div></div> <canvas id="live2d" width="280" height="250" class="live2d" data-v-1c077c9b></canvas></div> <div class="bg"></div> <div class="index-box" data-v-82e3e2fc><div class="nav-box" data-v-0bc0d532 data-v-82e3e2fc><div class="search-nav"><div class="search-box" data-v-6597e726><input autofocus="autofocus" placeholder="搜索" value="" data-v-6597e726> <!----></div></div> <div class="nav"></div> <div class="info-box" data-v-0bc0d532><img src="https://yating.online/res/img/yating.jpg" class="my-phone" data-v-0bc0d532> <div class="info" data-v-0bc0d532><div data-v-0bc0d532><div class="my-name" data-v-0bc0d532>WANGJIYUAN</div> <div class="des" data-v-0bc0d532>懒得翻身的咸鱼</div></div></div></div></div> <div class="box" data-v-69b40e18 data-v-82e3e2fc><div class="tag-box" data-v-69b40e18><div class="tag-item" data-v-69b40e18><div class="tag-name" data-v-69b40e18>全部</div> <div class="tag-num" data-v-69b40e18>0</div></div> </div></div> <div class="content-box" data-v-82e3e2fc><div class="content"><div class="catalog-item-big"><div class="title">
                    
                </div> <div class="article-time">
                    5/16/2021, 9:43:11 PM
                </div></div> <div class="content__default"><h1 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h1> <h1 id="二-docker的基本操作"><a href="#二-docker的基本操作" class="header-anchor">#</a> 二.Docker的基本操作</h1> <h2 id="_2-1安装dockers"><a href="#_2-1安装dockers" class="header-anchor">#</a> 2.1安装Dockers</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token number">0</span>. <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> yum <span class="token comment">#安装yum命令</span>
yum -y <span class="token function">install</span> yum-utils   	<span class="token comment">#安装工具包</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#想安装Docker，需要先将依赖的环境全部下载下来，就像Maven依赖JDK一样</span>
yum -y <span class="token function">install</span> yum-utils device-mapper-persistent-data lvm2
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 1.设置Dockers镜像源</span>
yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 4安装成功后，需要手动启动，设置为开机启动，并测试一下 Docker</span>
<span class="token comment">#启动docker服务</span>
systemctl start docker
<span class="token comment">#设置开机自动启动</span>
systemctl <span class="token builtin class-name">enable</span> docker
<span class="token comment">#测试</span>
docker run hello-world
</code></pre></div><h2 id="_2-2docker的中央仓库"><a href="#_2-2docker的中央仓库" class="header-anchor">#</a> 2.2Docker的中央仓库</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 修改配置文件</span>
<span class="token function">vim</span> /etc/docker/daemon.json

<span class="token punctuation">{</span>
	<span class="token string">&quot;registry-mirrors&quot;</span>:<span class="token punctuation">[</span><span class="token string">&quot;https://registry.docker-cn.com&quot;</span><span class="token punctuation">]</span>,
	<span class="token string">&quot;insecure-registries&quot;</span>:<span class="token punctuation">[</span><span class="token string">&quot;ip:port&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">#使用公共仓库</span>
<span class="token assign-left variable">DOCKER_OPTS</span><span class="token operator">=</span><span class="token string">&quot;--registry-mirror=http://yourRegist.m.daocloud.io&quot;</span>
<span class="token assign-left variable">DOCKER_OPTS</span><span class="token operator">=</span><span class="token string">&quot;--registry-mirror=http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo&quot;</span>
<span class="token comment">#重启两个服务</span>
systemctl daemon-reload
systemctl restart docker
</code></pre></div><h3 id="国内可用加速服务"><a href="#国内可用加速服务" class="header-anchor">#</a> 国内可用加速服务</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">vi</span> /etc/docker/daemon.json
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 中科大镜像</span>
<span class="token punctuation">{</span><span class="token string">&quot;registry-mirrors&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

<span class="token comment">#阿里云镜像</span>
<span class="token function">sudo</span> <span class="token function">mkdir</span> -p /etc/docker
<span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">'EOF'
{
  &quot;registry-mirrors&quot;: [&quot;https://332attgo.mirror.aliyuncs.com&quot;]
}
EOF</span>
<span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl restart docker
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code>systemctl daemon-reload
systemctl restart docker
</code></pre></div><h2 id="_2-3镜像的操作"><a href="#_2-3镜像的操作" class="header-anchor">#</a> 2.3镜像的操作</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#1.拉取镜像到本地</span>
docker pull 镜像名称<span class="token punctuation">[</span>:tag<span class="token punctuation">]</span>
<span class="token comment">#例子</span>
docker pull daocloud.io/library/nginx:latest  <span class="token comment">#拉取Nginx</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#2.查看本地全部镜像</span>
docker images
</code></pre></div><p><img src="C:%5CUsers%5C79443%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200818001627538.png" alt="image-20200818001627538"></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#3.删除本地镜像</span>
docker rmi 镜像的标识，Image ID
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#4.镜像的导入导出（不规范）</span>
<span class="token comment">#将本地镜像导出</span>
docker save -o 导出的路径 镜像id
<span class="token comment">#加载本地镜像</span>
docker load -i 镜像文件
<span class="token comment">#修改镜像名称</span>
docker tag 镜像id 新镜像名称:tag
</code></pre></div><h2 id="_2-4容器的操作"><a href="#_2-4容器的操作" class="header-anchor">#</a> 2.4容器的操作</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>运行容器需要定制具体镜像，如果镜像不存在，会直接下载
<span class="token comment">#1简单操作</span>
docker run 镜像的标识<span class="token operator">|</span>镜像的名称<span class="token punctuation">[</span>:tag<span class="token punctuation">]</span>
<span class="token comment">#常用的参数</span>
docker run -d -p 宿主机端口:容器端口 --name 容器名称 镜像的标识<span class="token operator">|</span>镜像名称<span class="token punctuation">[</span>:tag<span class="token punctuation">]</span>
<span class="token comment">#-d:代表后台运行容器</span>
<span class="token comment">#-p 宿主机端口:容器端口：为了映射当前Linux的端口和容器的端口</span>
<span class="token comment">#--name 容器名称:指定容器的名称</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#2查看全部正在运行的容器信息</span>
docker <span class="token function">ps</span> <span class="token punctuation">[</span>-qa<span class="token punctuation">]</span>
<span class="token comment">#-a 查看全部的容器，包括没有运行</span>
<span class="token comment">#-q 只查看容器的标识</span>
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">#3查看容器的日志</span>
docker logs -f IMAGEID
<span class="token comment">#-f:滚动查看后几行</span>
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">#4.进入到容器内部</span>
docker <span class="token builtin class-name">exec</span> -it 容器ID <span class="token function">bash</span>
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">#5.删除容器</span>
docker stop 容器ID  <span class="token comment">#停止指定容器</span>
docker <span class="token function">rm</span> 镜像ID <span class="token comment">#删除指定容器</span>

docker stop <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -qa<span class="token variable">)</span></span> <span class="token comment">#停止全部容器</span>
docker <span class="token function">rm</span> <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -qa<span class="token variable">)</span></span>  <span class="token comment">#删除全部容器</span>
</code></pre></div><hr> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">#6.启动容器</span>
docker start 容器id
</code></pre></div><h1 id="三-docker应用"><a href="#三-docker应用" class="header-anchor">#</a> 三.Docker应用</h1> <h2 id="_3-1准备ssm工程"><a href="#_3-1准备ssm工程" class="header-anchor">#</a> 3.1准备SSM工程</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">#运行Tomcat容器，为部署ssm工程做准备</span>
 
docker run -d -p <span class="token number">8080</span>:8080 --name tomcat  daocloud.io/library/tomcat:8.5.15-jre8
<span class="token comment">#或者已经下载了tomcat镜像</span>
docker run -d -p <span class="token number">8080</span>:8080 --name tomcat 镜像的标识
</code></pre></div><h2 id="_3-2准备mysql容器"><a href="#_3-2准备mysql容器" class="header-anchor">#</a> 3.2准备Mysql容器</h2> <div class="language-sh extra-class"><pre class="language-sh"><code>docker pull mysql/mysql-server:8.0

 docker volume create helloworld
 
 docker run -d -e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>root -v helloworld:/var/lib/mysql -p <span class="token number">3306</span>:3306 mysql:8.0

docker run -d -p <span class="token number">3306</span>:3306 --name mysql -e MYSQL-ROOT-PASSWORD<span class="token operator">=</span>root e1c
</code></pre></div><h2 id="_3-3准备tomcat容器"><a href="#_3-3准备tomcat容器" class="header-anchor">#</a> 3.3准备Tomcat容器</h2> <h1 id="容器的另类操作-操作容器"><a href="#容器的另类操作-操作容器" class="header-anchor">#</a> 容器的另类操作（操作容器）</h1> <h2 id="tomcat管理"><a href="#tomcat管理" class="header-anchor">#</a> Tomcat管理</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>docker <span class="token builtin class-name">exec</span> -it 容器id /bin/bash <span class="token comment">#会进入tomcat目录，查看webapps发现是空文件夹，webapps.dist有内容，删除webapps，重命名webapps.dist为webapps</span>
</code></pre></div><h1 id="四-docker-容器管理"><a href="#四-docker-容器管理" class="header-anchor">#</a> 四.Docker 容器管理</h1> <h3 id="查看docker容器详情"><a href="#查看docker容器详情" class="header-anchor">#</a> 查看Docker容器详情</h3> <div class="language-sh extra-class"><pre class="language-sh"><code>docker inspect <span class="token punctuation">[</span>ID<span class="token punctuation">]</span>
</code></pre></div><h3 id="进入容器目录"><a href="#进入容器目录" class="header-anchor">#</a> 进入容器目录</h3> <div class="language-sh extra-class"><pre class="language-sh"><code> docker <span class="token builtin class-name">exec</span> -it <span class="token punctuation">[</span>ID<span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token environment constant">PATH</span><span class="token punctuation">}</span>
 <span class="token comment"># 上一个步骤中的PATH</span>
</code></pre></div><h3 id="定时重启docker容器"><a href="#定时重启docker容器" class="header-anchor">#</a> 定时重启Docker容器</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 例如：此shell 脚本名为jd.sh</span>
<span class="token comment">#! /bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;重启京东镜像&quot;</span>
docker restart <span class="token punctuation">{</span>容器ID<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token variable">$?</span> -eq <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;执行成功!&quot;</span> <span class="token operator">&gt;&gt;</span> jd_run.log
<span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;执行失败&quot;</span> <span class="token operator">&gt;&gt;</span> jd_run.log
        <span class="token builtin class-name">exit</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;重启完毕&quot;</span> <span class="token operator">&gt;&gt;</span> jd_run.log
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">crontab</span> -e <span class="token comment">#加入定时任务的sh路径脚本</span>
<span class="token number">1</span> <span class="token number">9</span> * * * /root/docker_sh/jd.sh
<span class="token function">crontab</span> -l <span class="token comment">#查看定时任务</span>
</code></pre></div></div> <!----> <!----> <div class="over">
            完
            <div class="block"></div></div> <div id="gitalk-container"></div></div> <div class="catalog "><!----> <div class="level1"></div> <a href="#_2-1安装dockers" nofollow class="level2">2.1安装Dockers</a><a href="#_2-2docker的中央仓库" nofollow class="level2">2.2Docker的中央仓库</a><a href="#国内可用加速服务" nofollow class="level3">国内可用加速服务</a><a href="#_2-3镜像的操作" nofollow class="level2">2.3镜像的操作</a><a href="#_2-4容器的操作" nofollow class="level2">2.4容器的操作</a><a href="#_3-1准备ssm工程" nofollow class="level2">3.1准备SSM工程</a><a href="#_3-2准备mysql容器" nofollow class="level2">3.2准备Mysql容器</a><a href="#_3-3准备tomcat容器" nofollow class="level2">3.3准备Tomcat容器</a><a href="#tomcat管理" nofollow class="level2">Tomcat管理</a><a href="#查看docker容器详情" nofollow class="level3">查看Docker容器详情</a><a href="#进入容器目录" nofollow class="level3">进入容器目录</a><a href="#定时重启docker容器" nofollow class="level3">定时重启Docker容器</a> <!----></div> <!----></div></div> <div class="foot"> WANG JIYUAN BLOG</div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.45c0c6a5.js" defer></script><script src="/assets/js/2.b44b4809.js" defer></script><script src="/assets/js/10.21bb6e9c.js" defer></script>
  </body>
</html>
